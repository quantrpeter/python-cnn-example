<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600">
  <!-- Title -->
  <text x="600" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">CNN Training Process</text>
  <text x="600" y="55" font-size="14" text-anchor="middle" fill="#666">Complete training loop: Forward Pass → Loss → Backward Pass → Update</text>
  
  <!-- Step 1: Forward Pass -->
  <g id="forward-pass">
    <rect x="50" y="80" width="250" height="200" fill="#E8F4F8" stroke="#3498DB" stroke-width="3" rx="10"/>
    <text x="175" y="110" font-size="18" font-weight="bold" text-anchor="middle" fill="#3498DB">1. Forward Pass</text>
    
    <!-- Input -->
    <rect x="70" y="130" width="30" height="40" fill="#95A5A6" stroke="#666" stroke-width="1"/>
    <text x="85" y="177" font-size="10" text-anchor="middle" fill="#333">Input</text>
    
    <!-- Arrow -->
    <path d="M 100 150 L 120 150" stroke="#3498DB" stroke-width="2" marker-end="url(#arrow-forward)"/>
    
    <!-- Conv layers -->
    <rect x="120" y="135" width="20" height="30" fill="url(#grad-conv1)" stroke="#E74C3C" stroke-width="1"/>
    <path d="M 140 150 L 155 150" stroke="#3498DB" stroke-width="2" marker-end="url(#arrow-forward)"/>
    
    <rect x="155" y="140" width="18" height="20" fill="url(#grad-conv2)" stroke="#E67E22" stroke-width="1"/>
    <path d="M 173 150 L 188 150" stroke="#3498DB" stroke-width="2" marker-end="url(#arrow-forward)"/>
    
    <rect x="188" y="143" width="15" height="14" fill="url(#grad-conv3)" stroke="#9B59B6" stroke-width="1"/>
    <text x="195" y="177" font-size="9" text-anchor="middle" fill="#555">Conv</text>
    
    <!-- Arrow to FC -->
    <path d="M 203 150 L 220 150" stroke="#3498DB" stroke-width="2" marker-end="url(#arrow-forward)"/>
    
    <!-- FC layers -->
    <circle cx="235" cy="135" r="3" fill="#3498DB" stroke="none"/>
    <circle cx="235" cy="145" r="3" fill="#3498DB" stroke="none"/>
    <circle cx="235" cy="155" r="3" fill="#3498DB" stroke="none"/>
    <circle cx="235" cy="165" r="3" fill="#3498DB" stroke="none"/>
    <text x="235" y="177" font-size="9" text-anchor="middle" fill="#555">FC</text>
    
    <!-- Arrow to output -->
    <path d="M 245 150 L 260 150" stroke="#3498DB" stroke-width="2" marker-end="url(#arrow-forward)"/>
    
    <!-- Output -->
    <rect x="260" y="135" width="25" height="30" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
    <text x="272" y="152" font-size="12" text-anchor="middle" fill="#fff" font-weight="bold">ŷ</text>
    <text x="272" y="177" font-size="9" text-anchor="middle" fill="#555">Output</text>
    
    <!-- Description -->
    <text x="175" y="205" font-size="11" text-anchor="middle" fill="#555">Data flows through network</text>
    <text x="175" y="220" font-size="11" text-anchor="middle" fill="#555">Each layer transforms input</text>
    <text x="175" y="235" font-size="11" text-anchor="middle" fill="#555">Produces prediction ŷ</text>
    
    <rect x="70" y="245" width="210" height="25" fill="#D6EAF8" stroke="none" rx="5"/>
    <text x="175" y="262" font-size="10" text-anchor="middle" fill="#21618C" font-weight="bold">Input → Conv → Pool → FC → Output</text>
  </g>
  
  <!-- Arrow down -->
  <path d="M 300 280 L 350 280" stroke="#666" stroke-width="3" marker-end="url(#arrow-main)"/>
  
  <!-- Step 2: Compute Loss -->
  <g id="compute-loss">
    <rect x="350" y="80" width="250" height="200" fill="#FFF5E6" stroke="#F39C12" stroke-width="3" rx="10"/>
    <text x="475" y="110" font-size="18" font-weight="bold" text-anchor="middle" fill="#F39C12">2. Compute Loss</text>
    
    <!-- Prediction vs True -->
    <g id="comparison">
      <rect x="380" y="130" width="60" height="60" fill="#E8F8F5" stroke="#27AE60" stroke-width="2" rx="5"/>
      <text x="410" y="155" font-size="24" text-anchor="middle" fill="#27AE60" font-weight="bold">ŷ</text>
      <text x="410" y="175" font-size="10" text-anchor="middle" fill="#555">Prediction</text>
      <text x="410" y="188" font-size="9" text-anchor="middle" fill="#27AE60">[0.1, 0.2, 0.6, 0.1]</text>
      
      <!-- VS -->
      <text x="475" y="165" font-size="16" font-weight="bold" text-anchor="middle" fill="#666">vs</text>
      
      <rect x="510" y="130" width="60" height="60" fill="#FFE6E6" stroke="#E74C3C" stroke-width="2" rx="5"/>
      <text x="540" y="155" font-size="24" text-anchor="middle" fill="#E74C3C" font-weight="bold">y</text>
      <text x="540" y="175" font-size="10" text-anchor="middle" fill="#555">True Label</text>
      <text x="540" y="188" font-size="9" text-anchor="middle" fill="#E74C3C">[0, 0, 1, 0]</text>
    </g>
    
    <!-- Loss formula -->
    <rect x="370" y="205" width="210" height="40" fill="white" stroke="#F39C12" stroke-width="2" rx="5"/>
    <text x="475" y="222" font-size="12" text-anchor="middle" fill="#F39C12" font-weight="bold">Cross-Entropy Loss</text>
    <text x="475" y="238" font-size="11" text-anchor="middle" fill="#555" font-family="monospace">L = -Σ y log(ŷ)</text>
    
    <!-- Result -->
    <rect x="395" y="252" width="160" height="20" fill="#F39C12" stroke="none" rx="5"/>
    <text x="475" y="266" font-size="12" text-anchor="middle" fill="#fff" font-weight="bold">Loss = 0.51</text>
  </g>
  
  <!-- Arrow down -->
  <path d="M 600 280 L 650 280" stroke="#666" stroke-width="3" marker-end="url(#arrow-main)"/>
  
  <!-- Step 3: Backward Pass -->
  <g id="backward-pass">
    <rect x="650" y="80" width="250" height="200" fill="#FFE6F0" stroke="#E74C3C" stroke-width="3" rx="10"/>
    <text x="775" y="110" font-size="18" font-weight="bold" text-anchor="middle" fill="#E74C3C">3. Backward Pass</text>
    <text x="775" y="128" font-size="12" text-anchor="middle" fill="#666">(Backpropagation)</text>
    
    <!-- Gradient flow (reverse) -->
    <g id="gradients">
      <!-- Output gradient -->
      <rect x="845" y="145" width="35" height="20" fill="#E74C3C" stroke="#C0392B" stroke-width="1"/>
      <text x="862" y="158" font-size="9" text-anchor="middle" fill="#fff">∂L/∂ŷ</text>
      
      <path d="M 845 155 L 825 155" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrow-back)"/>
      
      <!-- FC gradient -->
      <circle cx="810" cy="145" r="3" fill="#E74C3C" stroke="none"/>
      <circle cx="810" cy="155" r="3" fill="#E74C3C" stroke="none"/>
      <circle cx="810" cy="165" r="3" fill="#E74C3C" stroke="none"/>
      <text x="810" y="180" font-size="8" text-anchor="middle" fill="#E74C3C">∂L/∂W₃</text>
      
      <path d="M 800 155 L 780 155" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrow-back)"/>
      
      <!-- Conv gradients -->
      <rect x="765" y="148" width="15" height="14" fill="#E74C3C" stroke="none"/>
      <text x="772" y="180" font-size="8" text-anchor="middle" fill="#E74C3C">∂L/∂W₂</text>
      
      <path d="M 765 155 L 745 155" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrow-back)"/>
      
      <rect x="730" y="150" width="15" height="10" fill="#E74C3C" stroke="none"/>
      <text x="737" y="180" font-size="8" text-anchor="middle" fill="#E74C3C">∂L/∂W₁</text>
      
      <path d="M 730 155 L 710 155" stroke="#E74C3C" stroke-width="2" marker-end="url(#arrow-back)"/>
      
      <!-- Input -->
      <rect x="670" y="145" width="30" height="20" fill="#95A5A6" stroke="#666" stroke-width="1" opacity="0.5"/>
    </g>
    
    <!-- Description -->
    <text x="775" y="200" font-size="11" text-anchor="middle" fill="#555">Compute gradients using</text>
    <text x="775" y="215" font-size="11" text-anchor="middle" fill="#555">chain rule (calculus)</text>
    <text x="775" y="230" font-size="11" text-anchor="middle" fill="#555">∂Loss/∂Weights for each layer</text>
    
    <rect x="670" y="245" width="210" height="25" fill="#FADBD8" stroke="none" rx="5"/>
    <text x="775" y="262" font-size="10" text-anchor="middle" fill="#922B21" font-weight="bold">Gradients flow backward through network</text>
  </g>
  
  <!-- Arrow down -->
  <path d="M 900 280 L 950 280" stroke="#666" stroke-width="3" marker-end="url(#arrow-main)"/>
  
  <!-- Step 4: Update Weights -->
  <g id="update-weights">
    <rect x="950" y="80" width="220" height="200" fill="#E8F8F5" stroke="#27AE60" stroke-width="3" rx="10"/>
    <text x="1060" y="110" font-size="18" font-weight="bold" text-anchor="middle" fill="#27AE60">4. Update Weights</text>
    <text x="1060" y="128" font-size="12" text-anchor="middle" fill="#666">(Optimization)</text>
    
    <!-- Weight update formula -->
    <rect x="970" y="145" width="180" height="80" fill="white" stroke="#27AE60" stroke-width="2" rx="5"/>
    <text x="1060" y="165" font-size="13" text-anchor="middle" fill="#27AE60" font-weight="bold">Adam Optimizer</text>
    
    <text x="1060" y="188" font-size="12" text-anchor="middle" fill="#555" font-family="monospace">W_new = W_old - α × ∇W</text>
    
    <text x="980" y="205" font-size="10" text-anchor="start" fill="#888">α = learning rate (0.001)</text>
    <text x="980" y="218" font-size="10" text-anchor="start" fill="#888">∇W = gradient</text>
    
    <!-- Description -->
    <text x="1060" y="245" font-size="11" text-anchor="middle" fill="#555">Adjust weights to reduce loss</text>
    <text x="1060" y="260" font-size="11" text-anchor="middle" fill="#555">Move in opposite direction</text>
    <text x="1060" y="275" font-size="11" text-anchor="middle" fill="#555">of gradient (downhill)</text>
  </g>
  
  <!-- Iteration loop arrow -->
  <path d="M 1060 290 Q 1060 350, 600 350 Q 140 350, 140 320" stroke="#9B59B6" stroke-width="3" stroke-dasharray="10,5" fill="none" marker-end="url(#arrow-loop)"/>
  <text x="600" y="370" font-size="14" text-anchor="middle" fill="#9B59B6" font-weight="bold">Repeat for each batch (iteration)</text>
  
  <!-- Bottom section: Training over time -->
  <g id="training-progress">
    <rect x="50" y="400" width="1120" height="180" fill="#F8F9FA" stroke="#3498DB" stroke-width="2" rx="10"/>
    <text x="610" y="430" font-size="18" font-weight="bold" text-anchor="middle" fill="#3498DB">Training Progress Over Time</text>
    
    <!-- Loss curve -->
    <g id="loss-curve">
      <text x="150" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="#E74C3C">Loss Decreases</text>
      
      <!-- Axes -->
      <line x1="80" y1="470" x2="80" y2="550" stroke="#333" stroke-width="2"/>
      <line x1="80" y1="550" x2="220" y2="550" stroke="#333" stroke-width="2"/>
      
      <!-- Loss curve -->
      <path d="M 80 480 Q 120 485, 140 510 T 180 535 T 220 545" stroke="#E74C3C" stroke-width="3" fill="none"/>
      
      <!-- Labels -->
      <text x="150" y="570" font-size="11" text-anchor="middle" fill="#666">Epochs →</text>
      <text x="60" y="510" font-size="11" text-anchor="end" fill="#666">Loss</text>
      
      <!-- Points -->
      <circle cx="80" cy="480" r="4" fill="#E74C3C" stroke="white" stroke-width="1"/>
      <circle cx="220" cy="545" r="4" fill="#E74C3C" stroke="white" stroke-width="1"/>
      
      <text x="80" y="472" font-size="9" text-anchor="middle" fill="#E74C3C">High</text>
      <text x="220" y="560" font-size="9" text-anchor="middle" fill="#E74C3C">Low</text>
    </g>
    
    <!-- Accuracy curve -->
    <g id="accuracy-curve">
      <text x="450" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="#27AE60">Accuracy Increases</text>
      
      <!-- Axes -->
      <line x1="350" y1="470" x2="350" y2="550" stroke="#333" stroke-width="2"/>
      <line x1="350" y1="550" x2="550" y2="550" stroke="#333" stroke-width="2"/>
      
      <!-- Accuracy curve -->
      <path d="M 350 545 Q 390 535, 420 510 T 490 480 T 550 475" stroke="#27AE60" stroke-width="3" fill="none"/>
      
      <!-- Labels -->
      <text x="450" y="570" font-size="11" text-anchor="middle" fill="#666">Epochs →</text>
      <text x="320" y="510" font-size="11" text-anchor="end" fill="#666">Accuracy</text>
      
      <!-- Points -->
      <circle cx="350" cy="545" r="4" fill="#27AE60" stroke="white" stroke-width="1"/>
      <circle cx="550" cy="475" r="4" fill="#27AE60" stroke="white" stroke-width="1"/>
      
      <text x="350" y="560" font-size="9" text-anchor="middle" fill="#27AE60">Low</text>
      <text x="550" y="468" font-size="9" text-anchor="middle" fill="#27AE60">High</text>
    </g>
    
    <!-- Key metrics -->
    <g id="metrics">
      <rect x="650" y="470" width="500" height="90" fill="white" stroke="#3498DB" stroke-width="1" rx="5"/>
      <text x="900" y="492" font-size="14" font-weight="bold" text-anchor="middle" fill="#3498DB">Key Training Metrics</text>
      
      <text x="670" y="515" font-size="12" fill="#555">• <tspan font-weight="bold">Batch Size:</tspan> 64 samples per iteration</text>
      <text x="670" y="532" font-size="12" fill="#555">• <tspan font-weight="bold">Learning Rate:</tspan> 0.001 (controls step size)</text>
      <text x="670" y="549" font-size="12" fill="#555">• <tspan font-weight="bold">Epochs:</tspan> Full pass through training data</text>
      
      <text x="930" y="515" font-size="12" fill="#555">• <tspan font-weight="bold">Iterations:</tspan> Total_samples / Batch_size</text>
      <text x="930" y="532" font-size="12" fill="#555">• <tspan font-weight="bold">Optimizer:</tspan> Adam (adaptive learning rates)</text>
      <text x="930" y="549" font-size="12" fill="#555">• <tspan font-weight="bold">Goal:</tspan> Minimize loss, maximize accuracy</text>
    </g>
  </g>
  
  <!-- Gradients -->
  <defs>
    <linearGradient id="grad-conv1" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FFB6B9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E74C3C;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad-conv2" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FAD7A0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E67E22;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad-conv3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#D7BDE2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#9B59B6;stop-opacity:1" />
    </linearGradient>
    
    <marker id="arrow-forward" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#3498DB" />
    </marker>
    <marker id="arrow-back" markerWidth="10" markerHeight="10" refX="1" refY="3" orient="auto">
      <polygon points="10 0, 0 3, 10 6" fill="#E74C3C" />
    </marker>
    <marker id="arrow-main" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666" />
    </marker>
    <marker id="arrow-loop" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#9B59B6" />
    </marker>
  </defs>
</svg>
