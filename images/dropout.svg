<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 450">
  <!-- Title -->
  <text x="450" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">Dropout Regularization</text>
  <text x="450" y="55" font-size="14" text-anchor="middle" fill="#666">Randomly drops neurons during training to prevent overfitting</text>
  
  <!-- Training phase -->
  <g id="training">
    <rect x="50" y="80" width="350" height="320" fill="#FFF9E6" stroke="#F39C12" stroke-width="2" rx="10"/>
    <text x="225" y="110" font-size="18" font-weight="bold" text-anchor="middle" fill="#F39C12">Training Phase</text>
    <text x="225" y="130" font-size="13" text-anchor="middle" fill="#666">Dropout p=0.5 (50% drop rate)</text>
    
    <!-- Input layer -->
    <g id="input-neurons">
      <text x="100" y="160" font-size="12" fill="#555">Input</text>
      <circle cx="100" cy="180" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="100" cy="210" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="100" cy="240" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="100" cy="270" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="100" cy="300" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="100" cy="330" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
    </g>
    
    <!-- Hidden layer with dropout -->
    <g id="hidden-neurons">
      <text x="225" y="160" font-size="12" fill="#555" text-anchor="middle">Hidden (with dropout)</text>
      
      <!-- Active neurons (green) -->
      <circle cx="225" cy="180" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="225" cy="240" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="225" cy="300" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      
      <!-- Dropped neurons (red with X) -->
      <circle cx="225" cy="210" r="8" fill="#E74C3C" stroke="#E74C3C" stroke-width="2" opacity="0.3"/>
      <line x1="220" y1="205" x2="230" y2="215" stroke="#fff" stroke-width="2"/>
      <line x1="230" y1="205" x2="220" y2="215" stroke="#fff" stroke-width="2"/>
      
      <circle cx="225" cy="270" r="8" fill="#E74C3C" stroke="#E74C3C" stroke-width="2" opacity="0.3"/>
      <line x1="220" y1="265" x2="230" y2="275" stroke="#fff" stroke-width="2"/>
      <line x1="230" y1="265" x2="220" y2="275" stroke="#fff" stroke-width="2"/>
      
      <circle cx="225" cy="330" r="8" fill="#E74C3C" stroke="#E74C3C" stroke-width="2" opacity="0.3"/>
      <line x1="220" y1="325" x2="230" y2="335" stroke="#fff" stroke-width="2"/>
      <line x1="230" y1="325" x2="220" y2="335" stroke="#fff" stroke-width="2"/>
    </g>
    
    <!-- Output layer -->
    <g id="output-neurons">
      <text x="350" y="160" font-size="12" fill="#555" text-anchor="end">Output</text>
      <circle cx="350" cy="210" r="8" fill="#9B59B6" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="350" cy="270" r="8" fill="#9B59B6" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="350" cy="330" r="8" fill="#9B59B6" stroke="#2C3E50" stroke-width="2"/>
    </g>
    
    <!-- Connections (only from active neurons) -->
    <g id="connections" opacity="0.3">
      <!-- From input to active hidden -->
      <line x1="108" y1="180" x2="217" y2="180" stroke="#27AE60" stroke-width="1"/>
      <line x1="108" y1="210" x2="217" y2="180" stroke="#27AE60" stroke-width="1"/>
      <line x1="108" y1="180" x2="217" y2="240" stroke="#27AE60" stroke-width="1"/>
      <line x1="108" y1="240" x2="217" y2="240" stroke="#27AE60" stroke-width="1"/>
      <line x1="108" y1="270" x2="217" y2="300" stroke="#27AE60" stroke-width="1"/>
      <line x1="108" y1="300" x2="217" y2="300" stroke="#27AE60" stroke-width="1"/>
      
      <!-- From active hidden to output -->
      <line x1="233" y1="180" x2="342" y2="210" stroke="#27AE60" stroke-width="1"/>
      <line x1="233" y1="240" x2="342" y2="270" stroke="#27AE60" stroke-width="1"/>
      <line x1="233" y1="300" x2="342" y2="330" stroke="#27AE60" stroke-width="1"/>
      
      <!-- Dropped connections (red, dashed) -->
      <line x1="108" y1="210" x2="217" y2="210" stroke="#E74C3C" stroke-width="1" stroke-dasharray="2,2" opacity="0.2"/>
      <line x1="108" y1="270" x2="217" y2="270" stroke="#E74C3C" stroke-width="1" stroke-dasharray="2,2" opacity="0.2"/>
      <line x1="108" y1="330" x2="217" y2="330" stroke="#E74C3C" stroke-width="1" stroke-dasharray="2,2" opacity="0.2"/>
    </g>
    
    <!-- Legend for training -->
    <circle cx="80" cy="370" r="6" fill="#27AE60"/>
    <text x="95" y="375" font-size="11" fill="#555">Active (kept)</text>
    
    <circle cx="200" cy="370" r="6" fill="#E74C3C" opacity="0.3"/>
    <text x="215" y="375" font-size="11" fill="#555">Dropped (p=0.5)</text>
  </g>
  
  <!-- Testing phase -->
  <g id="testing">
    <rect x="500" y="80" width="350" height="320" fill="#E8F8F5" stroke="#27AE60" stroke-width="2" rx="10"/>
    <text x="675" y="110" font-size="18" font-weight="bold" text-anchor="middle" fill="#27AE60">Testing Phase</text>
    <text x="675" y="130" font-size="13" text-anchor="middle" fill="#666">All neurons active (scaled by 0.5)</text>
    
    <!-- Input layer -->
    <g id="input-neurons-test">
      <text x="550" y="160" font-size="12" fill="#555">Input</text>
      <circle cx="550" cy="180" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="550" cy="210" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="550" cy="240" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="550" cy="270" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="550" cy="300" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="550" cy="330" r="8" fill="#3498DB" stroke="#2C3E50" stroke-width="2"/>
    </g>
    
    <!-- Hidden layer - all active -->
    <g id="hidden-neurons-test">
      <text x="675" y="160" font-size="12" fill="#555" text-anchor="middle">Hidden (all active)</text>
      
      <!-- All neurons active -->
      <circle cx="675" cy="180" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="675" cy="210" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="675" cy="240" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="675" cy="270" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="675" cy="300" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      <circle cx="675" cy="330" r="8" fill="#27AE60" stroke="#27AE60" stroke-width="2"/>
      
      <!-- Scaling indicator -->
      <text x="675" y="350" font-size="10" text-anchor="middle" fill="#E67E22" font-weight="bold">×0.5 scaling</text>
    </g>
    
    <!-- Output layer -->
    <g id="output-neurons-test">
      <text x="800" y="160" font-size="12" fill="#555" text-anchor="end">Output</text>
      <circle cx="800" cy="210" r="8" fill="#9B59B6" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="800" cy="270" r="8" fill="#9B59B6" stroke="#2C3E50" stroke-width="2"/>
      <circle cx="800" cy="330" r="8" fill="#9B59B6" stroke="#2C3E50" stroke-width="2"/>
    </g>
    
    <!-- All connections active -->
    <g id="connections-test" opacity="0.2">
      <line x1="558" y1="180" x2="667" y2="180" stroke="#27AE60" stroke-width="1"/>
      <line x1="558" y1="210" x2="667" y2="210" stroke="#27AE60" stroke-width="1"/>
      <line x1="558" y1="240" x2="667" y2="240" stroke="#27AE60" stroke-width="1"/>
      <line x1="558" y1="270" x2="667" y2="270" stroke="#27AE60" stroke-width="1"/>
      <line x1="558" y1="300" x2="667" y2="300" stroke="#27AE60" stroke-width="1"/>
      <line x1="558" y1="330" x2="667" y2="330" stroke="#27AE60" stroke-width="1"/>
      
      <line x1="683" y1="180" x2="792" y2="210" stroke="#27AE60" stroke-width="1"/>
      <line x1="683" y1="210" x2="792" y2="210" stroke="#27AE60" stroke-width="1"/>
      <line x1="683" y1="240" x2="792" y2="270" stroke="#27AE60" stroke-width="1"/>
      <line x1="683" y1="270" x2="792" y2="270" stroke="#27AE60" stroke-width="1"/>
      <line x1="683" y1="300" x2="792" y2="330" stroke="#27AE60" stroke-width="1"/>
      <line x1="683" y1="330" x2="792" y2="330" stroke="#27AE60" stroke-width="1"/>
    </g>
    
    <!-- Legend for testing -->
    <circle cx="580" cy="370" r="6" fill="#27AE60"/>
    <text x="595" y="375" font-size="11" fill="#555">All neurons active</text>
    
    <text x="730" y="375" font-size="11" fill="#E67E22" font-weight="bold">Outputs scaled by (1-p)</text>
  </g>
  
  <!-- Benefits box -->
  <rect x="150" y="410" width="600" height="35" fill="#F8F9FA" stroke="#ddd" stroke-width="1" rx="5"/>
  <text x="450" y="428" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Benefits:</text>
  <text x="450" y="442" font-size="11" text-anchor="middle" fill="#555">Prevents overfitting • Forces redundant representations • Acts like ensemble • Common: p=0.5 for FC layers, p=0.25 for Conv layers</text>
</svg>
